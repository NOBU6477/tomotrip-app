<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- SEO Meta Tags -->
    <title id="pageTitle">沖縄の協賛店・観光スポット一覧｜TomoTrip - 地元ガイドおすすめの店舗を探す</title>
    <meta name="description" id="metaDescription" content="TomoTrip協賛店一覧。沖縄の飲食店、観光案内、文化体験、アクティビティなど地元ガイドがおすすめする店舗を検索・予約。観光客と地域をつなぐプラットフォーム。">
    <meta name="keywords" content="沖縄,協賛店,観光,ガイド,TomoTrip,飲食店,アクティビティ,文化体験,那覇,観光案内">
    <meta name="author" content="TomoTrip">
    <meta name="robots" content="index, follow">
    <link rel="canonical" id="canonicalUrl" href="https://tomotrip.jp/sponsor-list.html">
    
    <!-- OGP (Open Graph Protocol) -->
    <meta property="og:title" id="ogTitle" content="沖縄の協賛店・観光スポット一覧｜TomoTrip">
    <meta property="og:description" id="ogDescription" content="地元ガイドがおすすめする沖縄の飲食店、観光案内、文化体験スポットを検索。観光客と地域をつなぐTomoTrip協賛店ネットワーク。">
    <meta property="og:type" content="website">
    <meta property="og:url" id="ogUrl" content="https://tomotrip.jp/sponsor-list.html">
    <meta property="og:image" content="https://tomotrip.jp/assets/images/sponsor-list-ogp.jpg">
    <meta property="og:site_name" content="TomoTrip">
    <meta property="og:locale" content="ja_JP">
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" id="twitterTitle" content="沖縄の協賛店・観光スポット一覧｜TomoTrip">
    <meta name="twitter:description" id="twitterDescription" content="地元ガイドがおすすめする沖縄の飲食店、観光案内、文化体験スポットを検索。">
    <meta name="twitter:image" content="https://tomotrip.jp/assets/images/sponsor-list-ogp.jpg">
    
    <!-- Favicon -->
    <link rel="icon" href="favicon.svg" type="image/svg+xml">
    
    <!-- CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">
    <link href="assets/css/ocean_background.css" rel="stylesheet">
    
    <!-- JSON-LD Structured Data -->
    <script type="application/ld+json" id="schemaWebsite">
    {
        "@context": "https://schema.org",
        "@type": "WebSite",
        "name": "TomoTrip",
        "url": "https://tomotrip.jp/",
        "description": "沖縄の地元ガイドと観光客をつなぐプラットフォーム",
        "potentialAction": {
            "@type": "SearchAction",
            "target": "https://tomotrip.jp/sponsor-list.html?search={search_term_string}",
            "query-input": "required name=search_term_string"
        }
    }
    </script>
    
    <script type="application/ld+json" id="schemaCollectionPage">
    {
        "@context": "https://schema.org",
        "@type": "CollectionPage",
        "name": "TomoTrip協賛店一覧",
        "description": "沖縄の飲食店、観光案内、文化体験、アクティビティなど地元ガイドがおすすめする店舗一覧",
        "url": "https://tomotrip.jp/sponsor-list.html",
        "isPartOf": {
            "@type": "WebSite",
            "name": "TomoTrip",
            "url": "https://tomotrip.jp/"
        },
        "mainEntity": {
            "@type": "ItemList",
            "itemListElement": []
        }
    }
    </script>
    
    <script type="application/ld+json" id="schemaBreadcrumb">
    {
        "@context": "https://schema.org",
        "@type": "BreadcrumbList",
        "itemListElement": [
            {
                "@type": "ListItem",
                "position": 1,
                "name": "ホーム",
                "item": "https://tomotrip.jp/"
            },
            {
                "@type": "ListItem",
                "position": 2,
                "name": "協賛店一覧",
                "item": "https://tomotrip.jp/sponsor-list.html"
            }
        ]
    }
    </script>
    
    <style>
        :root {
            --ocean-primary: #0077b6;
            --ocean-secondary: #00b4d8;
            --ocean-light: #90e0ef;
            --ocean-dark: #03045e;
            --sand-light: #f8f9fa;
            --coral: #ff6b6b;
            --sunset-orange: #ff8c42;
        }
        
        body {
            background: linear-gradient(135deg, var(--ocean-primary) 0%, var(--ocean-secondary) 50%, var(--ocean-light) 100%);
            min-height: 100vh;
            font-family: 'Noto Sans JP', -apple-system, BlinkMacSystemFont, sans-serif;
        }
        
        /* Hero Header */
        .sponsor-hero {
            background: linear-gradient(135deg, rgba(0, 119, 182, 0.95), rgba(0, 180, 216, 0.9));
            color: white;
            padding: 3rem 0 2rem;
            margin-bottom: 2rem;
            position: relative;
            overflow: hidden;
        }
        
        .sponsor-hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('assets/images/beach-yacht-tourists.jpg') center/cover;
            opacity: 0.15;
            z-index: 0;
        }
        
        .sponsor-hero .container {
            position: relative;
            z-index: 1;
        }
        
        .sponsor-hero h1 {
            font-size: 2.5rem;
            font-weight: 700;
            text-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }
        
        @media (max-width: 768px) {
            .sponsor-hero h1 {
                font-size: 1.75rem;
            }
            .sponsor-hero {
                padding: 2rem 0 1.5rem;
            }
        }
        
        /* Breadcrumb */
        .breadcrumb-nav {
            background: rgba(255,255,255,0.1);
            padding: 0.75rem 0;
            backdrop-filter: blur(10px);
        }
        
        .breadcrumb-nav a {
            color: rgba(255,255,255,0.8);
            text-decoration: none;
        }
        
        .breadcrumb-nav a:hover {
            color: white;
        }
        
        .breadcrumb-nav .separator {
            color: rgba(255,255,255,0.5);
            margin: 0 0.5rem;
        }
        
        .breadcrumb-nav .current {
            color: white;
            font-weight: 600;
        }
        
        /* CTA Buttons */
        .cta-primary {
            background: linear-gradient(135deg, var(--coral), var(--sunset-orange));
            border: none;
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 25px;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(255, 107, 107, 0.4);
        }
        
        .cta-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(255, 107, 107, 0.5);
            color: white;
        }
        
        .cta-secondary {
            background: white;
            color: var(--ocean-primary);
            border: 2px solid white;
            padding: 0.75rem 1.5rem;
            border-radius: 25px;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .cta-secondary:hover {
            background: rgba(255,255,255,0.9);
            transform: translateY(-2px);
        }
        
        /* Top CTA Bar */
        .top-cta-bar {
            background: linear-gradient(135deg, var(--coral), var(--sunset-orange));
            padding: 1rem 0;
            text-align: center;
        }
        
        .top-cta-bar p {
            color: white;
            margin: 0;
            font-weight: 600;
        }
        
        /* KPI Cards */
        .kpi-card {
            background: white;
            border-radius: 20px;
            padding: 1.5rem;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            border: none;
            text-align: center;
            height: 100%;
        }
        
        .kpi-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15);
        }
        
        .kpi-card .kpi-icon {
            width: 60px;
            height: 60px;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 1rem;
            font-size: 1.5rem;
        }
        
        .kpi-card .kpi-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--ocean-dark);
        }
        
        .kpi-card .kpi-label {
            color: #6c757d;
            font-size: 0.875rem;
        }
        
        /* Store Card */
        .store-card {
            background: white;
            border-radius: 20px;
            padding: 1.5rem;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.08);
            transition: all 0.3s ease;
            border: none;
            margin-bottom: 1.5rem;
            height: 100%;
        }
        
        .store-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.12);
        }
        
        .store-logo {
            width: 80px;
            height: 80px;
            border-radius: 15px;
            object-fit: cover;
            background: linear-gradient(135deg, var(--ocean-primary), var(--ocean-secondary));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 2rem;
        }
        
        .status-badge {
            padding: 0.25rem 0.75rem;
            border-radius: 15px;
            font-size: 0.75rem;
            font-weight: 600;
        }
        
        .status-active {
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
        }
        
        .status-pending {
            background: linear-gradient(135deg, #ffc107, #e0a800);
            color: white;
        }
        
        .btn-view-store {
            background: linear-gradient(135deg, var(--ocean-primary), var(--ocean-dark));
            border: none;
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 12px;
            transition: all 0.3s ease;
            font-weight: 600;
        }
        
        .btn-view-store:hover {
            background: linear-gradient(135deg, var(--ocean-dark), #010326);
            color: white;
            transform: translateY(-2px);
        }
        
        /* Search & Filter Section */
        .search-filter-section {
            background: rgba(255, 255, 255, 0.98);
            border-radius: 20px;
            padding: 1.5rem;
            margin-bottom: 2rem;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.1);
        }
        
        .filter-tabs {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
            margin-bottom: 1rem;
        }
        
        .filter-tab {
            padding: 0.5rem 1rem;
            border-radius: 20px;
            border: 2px solid var(--ocean-primary);
            background: white;
            color: var(--ocean-primary);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .filter-tab:hover, .filter-tab.active {
            background: var(--ocean-primary);
            color: white;
        }
        
        /* Pagination */
        .pagination-container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 1.5rem;
            margin-top: 2rem;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
        }
        
        .page-button {
            background: white;
            border: 2px solid var(--ocean-primary);
            color: var(--ocean-primary);
            padding: 0.5rem 1rem;
            margin: 0 0.25rem;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
        }
        
        .page-button:hover:not(:disabled) {
            background: var(--ocean-primary);
            color: white;
            transform: translateY(-2px);
        }
        
        .page-button.active {
            background: linear-gradient(135deg, var(--ocean-primary), var(--ocean-dark));
            color: white;
            border-color: transparent;
        }
        
        .page-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        /* About Section */
        .about-section {
            background: rgba(255,255,255,0.95);
            border-radius: 20px;
            padding: 2.5rem;
            margin-bottom: 2rem;
            box-shadow: 0 8px 30px rgba(0,0,0,0.1);
        }
        
        .about-section h2 {
            color: var(--ocean-dark);
            font-weight: 700;
            margin-bottom: 1rem;
        }
        
        .about-section p {
            color: #555;
            line-height: 1.8;
        }
        
        /* Benefit Cards */
        .benefit-card {
            background: linear-gradient(135deg, rgba(0,119,182,0.05), rgba(0,180,216,0.05));
            border-radius: 15px;
            padding: 1.5rem;
            text-align: center;
            height: 100%;
            border: 1px solid rgba(0,119,182,0.1);
        }
        
        .benefit-card i {
            font-size: 2.5rem;
            color: var(--ocean-primary);
            margin-bottom: 1rem;
        }
        
        .benefit-card h4 {
            color: var(--ocean-dark);
            font-weight: 600;
            margin-bottom: 0.5rem;
        }
        
        /* Bottom CTA Section */
        .bottom-cta-section {
            background: linear-gradient(135deg, var(--ocean-dark), var(--ocean-primary));
            border-radius: 25px;
            padding: 3rem 2rem;
            margin: 3rem 0;
            text-align: center;
            color: white;
            box-shadow: 0 15px 50px rgba(3,4,94,0.3);
        }
        
        .bottom-cta-section h2 {
            font-weight: 700;
            margin-bottom: 1rem;
        }
        
        /* FAQ Section */
        .faq-section {
            background: rgba(255,255,255,0.95);
            border-radius: 20px;
            padding: 2.5rem;
            margin-bottom: 2rem;
        }
        
        .faq-item {
            border-bottom: 1px solid #eee;
            padding: 1.5rem 0;
        }
        
        .faq-item:last-child {
            border-bottom: none;
        }
        
        .faq-question {
            font-weight: 600;
            color: var(--ocean-dark);
            margin-bottom: 0.5rem;
        }
        
        .faq-answer {
            color: #666;
            line-height: 1.7;
        }
        
        /* Filter Badges */
        .filter-badge {
            background: linear-gradient(135deg, var(--ocean-primary), var(--ocean-dark));
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.85rem;
            display: inline-flex;
            align-items: center;
            margin: 0.25rem;
        }
        
        .filter-badge .remove-filter {
            margin-left: 0.5rem;
            cursor: pointer;
            opacity: 0.8;
        }
        
        .filter-badge .remove-filter:hover {
            opacity: 1;
        }
        
        .sort-dropdown {
            border: 2px solid var(--ocean-primary);
            border-radius: 10px;
            padding: 0.5rem 1rem;
            background: white;
            cursor: pointer;
        }
        
        /* Footer */
        .sponsor-footer {
            background: var(--ocean-dark);
            color: white;
            padding: 2rem 0;
            margin-top: 3rem;
        }
        
        .sponsor-footer a {
            color: rgba(255,255,255,0.8);
            text-decoration: none;
        }
        
        .sponsor-footer a:hover {
            color: white;
        }
    </style>
</head>
<body>
    <!-- Top CTA Bar -->
    <div class="top-cta-bar">
        <div class="container">
            <p>
                <i class="bi bi-megaphone me-2"></i>
                あなたのお店もTomoTripに掲載しませんか？
                <a href="sponsor-registration.html" class="btn btn-light btn-sm ms-3" data-cta="top_bar_register">
                    今すぐ無料で掲載相談
                </a>
            </p>
        </div>
    </div>
    
    <!-- Breadcrumb -->
    <nav class="breadcrumb-nav" aria-label="パンくずリスト">
        <div class="container">
            <a href="index.html"><i class="bi bi-house-door me-1"></i>ホーム</a>
            <span class="separator">/</span>
            <span class="current">協賛店一覧</span>
        </div>
    </nav>
    
    <!-- Hero Header -->
    <header class="sponsor-hero">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-lg-7 mb-4 mb-lg-0">
                    <h1>
                        <i class="bi bi-shop-window me-2"></i>
                        TomoTrip 協賛店一覧
                    </h1>
                    <p class="lead mb-3 opacity-90">
                        沖縄の地元ガイドがおすすめする飲食店・観光スポット・アクティビティを検索
                    </p>
                    <p class="mb-4 opacity-75">
                        TomoTripの協賛店ネットワークは、地元ガイドと連携した信頼できる店舗のみを掲載。<br>
                        観光客の皆様に本当におすすめできるお店だけをご紹介しています。
                    </p>
                    <div class="d-flex flex-wrap gap-2">
                        <a href="index.html" class="btn cta-secondary" data-cta="hero_find_guide">
                            <i class="bi bi-person-badge me-1"></i>ガイドを探す
                        </a>
                        <a href="tourist-registration-simple.html" class="btn cta-secondary" data-cta="hero_tourist_register">
                            <i class="bi bi-person-plus me-1"></i>観光客登録
                        </a>
                        <a href="sponsor-registration.html" class="btn cta-primary" data-cta="hero_sponsor_register">
                            <i class="bi bi-plus-circle me-1"></i>協賛店登録
                        </a>
                        <button class="btn btn-warning" id="sponsorEditBtn" data-cta="hero_sponsor_edit" style="border-radius: 25px;">
                            <i class="bi bi-pencil-square me-1"></i>協賛店編集
                        </button>
                    </div>
                </div>
                <div class="col-lg-5 text-center">
                    <div class="d-none d-lg-block">
                        <img src="assets/images/tomotrip-logo.png" alt="TomoTrip" style="max-width: 200px; filter: drop-shadow(0 5px 15px rgba(0,0,0,0.3));">
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- メインコンテンツ -->
    <main class="container">
        <!-- KPI統計情報 -->
        <section class="row mb-4" aria-label="統計情報">
            <div class="col-md-3 col-6 mb-3">
                <div class="kpi-card">
                    <div class="kpi-icon" style="background: linear-gradient(135deg, #667eea, #764ba2);">
                        <i class="bi bi-shop text-white"></i>
                    </div>
                    <div class="kpi-value" id="totalStores">0</div>
                    <div class="kpi-label">登録店舗数</div>
                </div>
            </div>
            <div class="col-md-3 col-6 mb-3">
                <div class="kpi-card">
                    <div class="kpi-icon" style="background: linear-gradient(135deg, #28a745, #20c997);">
                        <i class="bi bi-eye text-white"></i>
                    </div>
                    <div class="kpi-value" id="displayedStores">0</div>
                    <div class="kpi-label">表示中</div>
                </div>
            </div>
            <div class="col-md-3 col-6 mb-3">
                <div class="kpi-card">
                    <div class="kpi-icon" style="background: linear-gradient(135deg, #17a2b8, #0dcaf0);">
                        <i class="bi bi-check-circle text-white"></i>
                    </div>
                    <div class="kpi-value" id="activeStores">0</div>
                    <div class="kpi-label">アクティブ</div>
                </div>
            </div>
            <div class="col-md-3 col-6 mb-3">
                <div class="kpi-card">
                    <div class="kpi-icon" style="background: linear-gradient(135deg, #ffc107, #ff8c42);">
                        <i class="bi bi-star-fill text-white"></i>
                    </div>
                    <div class="kpi-value">4.8</div>
                    <div class="kpi-label">平均評価</div>
                </div>
            </div>
        </section>

        <!-- TomoTrip協賛店とは（SEO用本文） -->
        <section class="about-section">
            <h2><i class="bi bi-info-circle me-2"></i>TomoTrip協賛店とは</h2>
            <p>
                TomoTrip協賛店は、沖縄の地元ガイドネットワークと連携した信頼できる店舗・サービスです。
                飲食店、観光案内所、文化体験施設、アクティビティ提供者など、多様な業種の事業者様が参加しています。
                協賛店に登録すると、TomoTripのガイドからお客様を紹介してもらえるほか、プラットフォーム上での露出が増え、集客効果が期待できます。
            </p>
            
            <h3 class="h5 mt-4 mb-3">掲載メリット</h3>
            <div class="row g-3">
                <div class="col-md-4">
                    <div class="benefit-card">
                        <i class="bi bi-people-fill"></i>
                        <h4>ガイド紹介で集客</h4>
                        <p class="text-muted small mb-0">地元ガイドからの直接紹介で新規顧客を獲得</p>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="benefit-card">
                        <i class="bi bi-graph-up-arrow"></i>
                        <h4>露出アップ</h4>
                        <p class="text-muted small mb-0">TomoTripプラットフォームでの検索上位表示</p>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="benefit-card">
                        <i class="bi bi-shield-check"></i>
                        <h4>信頼性向上</h4>
                        <p class="text-muted small mb-0">TomoTrip認定マークで観光客からの信頼獲得</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- カテゴリ別ナビゲーション -->
        <section class="mb-4" aria-label="カテゴリで探す">
            <h2 class="text-white h4 mb-3"><i class="bi bi-grid me-2"></i>カテゴリから探す</h2>
            <div class="filter-tabs" id="categoryTabs">
                <button class="filter-tab active" data-category="" data-cta="filter_all">すべて</button>
                <button class="filter-tab" data-category="観光案内" data-cta="filter_tourism">観光案内</button>
                <button class="filter-tab" data-category="文化体験" data-cta="filter_culture">文化体験</button>
                <button class="filter-tab" data-category="アクティビティ" data-cta="filter_activity">アクティビティ</button>
                <button class="filter-tab" data-category="飲食" data-cta="filter_food">飲食</button>
                <button class="filter-tab" data-category="飲み屋" data-cta="filter_bar">飲み屋</button>
                <button class="filter-tab" data-category="宿泊" data-cta="filter_stay">宿泊</button>
                <button class="filter-tab" data-category="交通" data-cta="filter_transport">交通</button>
            </div>
        </section>

        <!-- 検索・フィルター・ソート -->
        <section class="search-filter-section" aria-label="検索・フィルター">
            <div class="row g-3">
                <!-- 検索バー -->
                <div class="col-md-5">
                    <div class="input-group">
                        <span class="input-group-text" style="border-radius: 10px 0 0 10px;">
                            <i class="bi bi-search"></i>
                        </span>
                        <input type="text" id="searchInput" class="form-control" placeholder="店舗名・住所で検索..." style="border-radius: 0 10px 10px 0;">
                    </div>
                </div>
                
                <!-- エリアフィルター -->
                <div class="col-md-3">
                    <select id="areaFilter" class="form-select sort-dropdown">
                        <option value="">全エリア</option>
                        <option value="naha">那覇</option>
                        <option value="chatan">北谷</option>
                        <option value="nago">名護</option>
                        <option value="ishigaki">石垣</option>
                        <option value="miyako">宮古</option>
                    </select>
                </div>
                
                <!-- ソート -->
                <div class="col-md-2">
                    <select id="sortSelect" class="form-select sort-dropdown">
                        <option value="oldest" selected>登録順</option>
                        <option value="newest">新着順</option>
                        <option value="name">名前順</option>
                        <option value="views">人気順</option>
                    </select>
                </div>
                
                <!-- カテゴリーフィルター（隠し、タブと連動） -->
                <input type="hidden" id="categoryFilter" value="">
                
                <!-- リセットボタン -->
                <div class="col-md-2">
                    <button class="btn btn-outline-secondary w-100" onclick="resetFilters()" style="border-radius: 10px;">
                        <i class="bi bi-arrow-clockwise me-1"></i>リセット
                    </button>
                </div>
            </div>
            
            <!-- アクティブなフィルター表示 -->
            <div id="activeFilters" class="mt-3" style="display: none;">
                <small class="text-muted me-2">アクティブなフィルター:</small>
                <div id="filterBadges" class="d-inline"></div>
            </div>
        </section>

        <!-- 協賛店リスト -->
        <section id="storeList" class="row" aria-label="協賛店一覧">
            <!-- 店舗カードがここに動的に挿入されます -->
        </section>
        
        <!-- ページネーション -->
        <nav id="paginationContainer" class="pagination-container text-center" style="display: none;" aria-label="ページナビゲーション">
            <div class="d-flex justify-content-between align-items-center flex-wrap">
                <div class="mb-2">
                    <span class="text-muted">
                        <span id="currentRange">1-12</span> / <span id="totalItemsDisplay">0</span> 件
                    </span>
                </div>
                
                <div id="paginationButtons" class="mb-2">
                    <!-- ページネーションボタンがここに動的に生成されます -->
                </div>
                
                <div class="mb-2">
                    <span class="text-muted">
                        ページ <span id="currentPageDisplay">1</span> / <span id="totalPagesDisplay">1</span>
                    </span>
                </div>
            </div>
        </nav>
        
        <!-- ローディング -->
        <div id="loading" class="text-center py-5" aria-live="polite">
            <div class="spinner-border text-light" role="status">
                <span class="visually-hidden">読み込み中...</span>
            </div>
            <p class="mt-3 text-white">協賛店情報を読み込み中...</p>
        </div>
        
        <!-- 空の状態 -->
        <div id="emptyState" class="text-center py-5" style="display: none;">
            <i class="bi bi-shop text-white" style="font-size: 4rem; opacity: 0.5;"></i>
            <h3 class="text-white mt-3">協賛店が見つかりません</h3>
            <p class="text-white opacity-75">検索条件を変更するか、新しい協賛店を登録してください</p>
            <button class="btn btn-light me-2" onclick="resetFilters()">
                <i class="bi bi-arrow-clockwise me-1"></i>フィルターをリセット
            </button>
            <a href="sponsor-registration.html" class="btn btn-success" data-cta="empty_register">
                <i class="bi bi-plus-circle me-1"></i>協賛店を登録
            </a>
        </div>

        <!-- Bottom CTA Section -->
        <section class="bottom-cta-section">
            <h2><i class="bi bi-rocket-takeoff me-2"></i>あなたのお店も掲載しませんか？</h2>
            <p class="lead mb-4">TomoTripの協賛店ネットワークに参加して、沖縄を訪れる観光客にアピールしましょう</p>
            <div class="d-flex flex-wrap justify-content-center gap-3">
                <a href="sponsor-registration.html" class="btn btn-lg cta-primary" data-cta="bottom_register">
                    <i class="bi bi-plus-circle me-2"></i>今すぐ無料で掲載相談
                </a>
                <a href="index.html" class="btn btn-lg btn-outline-light" data-cta="bottom_home">
                    <i class="bi bi-house me-2"></i>TomoTripトップへ
                </a>
            </div>
        </section>

        <!-- FAQ Section -->
        <section class="faq-section" aria-label="よくある質問">
            <h2 class="mb-4"><i class="bi bi-question-circle me-2"></i>よくある質問</h2>
            
            <div class="faq-item">
                <div class="faq-question">Q. 協賛店への登録は無料ですか？</div>
                <div class="faq-answer">A. 基本的な掲載は無料です。プレミアム掲載などのオプションサービスは別途料金がかかります。まずはお気軽にご相談ください。</div>
            </div>
            
            <div class="faq-item">
                <div class="faq-question">Q. どのような業種が登録できますか？</div>
                <div class="faq-answer">A. 飲食店、観光案内所、文化体験施設、アクティビティ提供者、宿泊施設、交通サービスなど、観光に関連する幅広い業種が登録可能です。</div>
            </div>
            
            <div class="faq-item">
                <div class="faq-question">Q. ガイドからの紹介はどのように行われますか？</div>
                <div class="faq-answer">A. TomoTripに登録している地元ガイドが、ツアー中やお客様への案内時に協賛店を紹介します。紹介実績に応じたコミッション制度もあります。</div>
            </div>
            
            <div class="faq-item">
                <div class="faq-question">Q. 掲載後の運用サポートはありますか？</div>
                <div class="faq-answer">A. はい、専任のサポートチームが掲載内容の最適化や集客のアドバイスを行います。</div>
            </div>
        </section>

        <!-- お問い合わせ導線 -->
        <section class="about-section text-center">
            <h2 class="mb-3"><i class="bi bi-envelope me-2"></i>お問い合わせ</h2>
            <p class="mb-4">協賛店登録やサービスについてのご質問はお気軽にどうぞ</p>
            <div class="d-flex flex-wrap justify-content-center gap-3">
                <a href="mailto:info@tomotrip.jp" class="btn btn-outline-primary" data-cta="contact_email">
                    <i class="bi bi-envelope me-2"></i>メールでお問い合わせ
                </a>
                <a href="sponsor-registration.html" class="btn cta-primary" data-cta="contact_register">
                    <i class="bi bi-plus-circle me-2"></i>掲載を申し込む
                </a>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="sponsor-footer">
        <div class="container">
            <div class="row">
                <div class="col-md-4 mb-3">
                    <h5>TomoTrip</h5>
                    <p class="small opacity-75">沖縄の地元ガイドと観光客をつなぐプラットフォーム</p>
                </div>
                <div class="col-md-4 mb-3">
                    <h6>リンク</h6>
                    <ul class="list-unstyled small">
                        <li><a href="index.html">ホーム</a></li>
                        <li><a href="sponsor-list.html">協賛店一覧</a></li>
                        <li><a href="sponsor-registration.html">協賛店登録</a></li>
                        <li><a href="tourist-registration-simple.html">観光客登録</a></li>
                    </ul>
                </div>
                <div class="col-md-4 mb-3">
                    <h6>お問い合わせ</h6>
                    <p class="small opacity-75">
                        <i class="bi bi-envelope me-1"></i> info@tomotrip.jp
                    </p>
                </div>
            </div>
            <hr class="opacity-25">
            <p class="text-center small opacity-50 mb-0">&copy; 2025 TomoTrip. All rights reserved.</p>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // グローバル変数
        let allStores = [];
        let filteredStores = [];
        let currentPage = 1;
        const itemsPerPage = 12;
        
        // SEO: URLパラメータから初期フィルターを取得
        const urlParams = new URLSearchParams(window.location.search);
        const initialCategory = urlParams.get('category') || '';
        const initialArea = urlParams.get('area') || '';
        const initialSearch = urlParams.get('search') || '';
        
        // 初期化
        document.addEventListener('DOMContentLoaded', function() {
            // URLパラメータからフィルターを適用
            applyUrlParams();
            
            // SEO: 動的にtitle/descriptionを更新
            updateSeoMeta();
            
            loadSponsorStores();
            setupEventListeners();
            setupCategoryTabs();
            trackCtaClicks();
        });
        
        // URLパラメータの適用
        function applyUrlParams() {
            if (initialCategory) {
                document.getElementById('categoryFilter').value = initialCategory;
                // タブも更新
                document.querySelectorAll('.filter-tab').forEach(tab => {
                    tab.classList.toggle('active', tab.dataset.category === initialCategory);
                });
            }
            if (initialArea) {
                document.getElementById('areaFilter').value = initialArea;
            }
            if (initialSearch) {
                document.getElementById('searchInput').value = initialSearch;
            }
        }
        
        // SEO: 動的メタ更新
        function updateSeoMeta() {
            const categoryNames = {
                '観光案内': '観光案内',
                '文化体験': '文化体験',
                'アクティビティ': 'アクティビティ',
                '飲食': '飲食店・グルメ',
                '飲み屋': 'バー・スナック・キャバクラ',
                '宿泊': '宿泊施設',
                '交通': '交通サービス'
            };
            
            const areaNames = {
                'naha': '那覇',
                'chatan': '北谷',
                'nago': '名護',
                'ishigaki': '石垣島',
                'miyako': '宮古島'
            };
            
            let title = '沖縄の協賛店・観光スポット一覧｜TomoTrip';
            let description = 'TomoTrip協賛店一覧。沖縄の飲食店、観光案内、文化体験、アクティビティなど地元ガイドがおすすめする店舗を検索・予約。';
            
            if (initialCategory && categoryNames[initialCategory]) {
                title = `沖縄の${categoryNames[initialCategory]}一覧｜TomoTrip協賛店`;
                description = `沖縄の${categoryNames[initialCategory]}をお探しなら、TomoTrip協賛店で。地元ガイドがおすすめする信頼できる店舗をご紹介。`;
            }
            
            if (initialArea && areaNames[initialArea]) {
                title = `${areaNames[initialArea]}の協賛店一覧｜TomoTrip`;
                description = `${areaNames[initialArea]}エリアのTomoTrip協賛店。地元ガイドおすすめの飲食店、観光スポット、アクティビティを検索。`;
            }
            
            if (initialCategory && initialArea) {
                title = `${areaNames[initialArea]}の${categoryNames[initialCategory]}一覧｜TomoTrip`;
                description = `${areaNames[initialArea]}エリアの${categoryNames[initialCategory]}をお探しなら、TomoTrip協賛店で。`;
            }
            
            // Update meta tags
            document.getElementById('pageTitle').textContent = title;
            document.querySelector('meta[name="description"]').content = description;
            document.getElementById('ogTitle').content = title;
            document.getElementById('ogDescription').content = description;
            document.getElementById('twitterTitle').content = title;
            document.getElementById('twitterDescription').content = description;
        }
        
        // カテゴリタブのセットアップ
        function setupCategoryTabs() {
            document.querySelectorAll('.filter-tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    // タブのアクティブ状態を更新
                    document.querySelectorAll('.filter-tab').forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    
                    // フィルターを更新
                    document.getElementById('categoryFilter').value = this.dataset.category;
                    applyFiltersAndSort();
                    
                    // URLを更新（履歴に追加しない）
                    updateUrl();
                });
            });
        }
        
        // URL更新
        function updateUrl() {
            const params = new URLSearchParams();
            const category = document.getElementById('categoryFilter').value;
            const area = document.getElementById('areaFilter').value;
            const search = document.getElementById('searchInput').value;
            
            if (category) params.set('category', category);
            if (area) params.set('area', area);
            if (search) params.set('search', search);
            
            const newUrl = params.toString() 
                ? `${window.location.pathname}?${params.toString()}`
                : window.location.pathname;
            
            window.history.replaceState({}, '', newUrl);
        }
        
        // CTAクリックトラッキング
        function trackCtaClicks() {
            document.querySelectorAll('[data-cta]').forEach(el => {
                el.addEventListener('click', function() {
                    const ctaName = this.dataset.cta;
                    console.log('CTA clicked:', ctaName);
                    // Analytics tracking can be added here
                    // gtag('event', 'cta_click', { cta_name: ctaName });
                });
            });
        }

        // イベントリスナーの設定
        function setupEventListeners() {
            // 検索
            document.getElementById('searchInput').addEventListener('input', debounce(function() {
                applyFiltersAndSort();
                updateUrl();
            }, 300));
            
            // ソート
            document.getElementById('sortSelect').addEventListener('change', applyFiltersAndSort);
            
            // エリアフィルター
            document.getElementById('areaFilter').addEventListener('change', function() {
                applyFiltersAndSort();
                updateUrl();
            });
        }

        // デバウンス関数
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }

        // 協賛店データの読み込み
        async function loadSponsorStores() {
            try {
                const response = await fetch('/api/sponsor-stores');
                if (!response.ok) throw new Error('Failed to load stores');
                
                allStores = await response.json();
                
                // デフォルト値の設定
                allStores = allStores.map(store => ({
                    ...store,
                    totalViews: store.totalViews || Math.floor(Math.random() * 500) + 100,
                    totalBookings: store.totalBookings || Math.floor(Math.random() * 50) + 10,
                    status: store.isActive ? 'active' : 'pending',
                    category: store.category || '観光案内'
                }));
                
                document.getElementById('loading').style.display = 'none';
                
                if (allStores.length === 0) {
                    document.getElementById('emptyState').style.display = 'block';
                } else {
                    applyFiltersAndSort();
                    updateStructuredData();
                }
                
            } catch (error) {
                console.error('Error loading sponsor stores:', error);
                document.getElementById('loading').style.display = 'none';
                document.getElementById('emptyState').style.display = 'block';
            }
        }
        
        // 構造化データの更新
        function updateStructuredData() {
            const itemList = filteredStores.slice(0, 20).map((store, index) => ({
                "@type": "ListItem",
                "position": index + 1,
                "item": {
                    "@type": "LocalBusiness",
                    "name": store.storeName,
                    "description": store.description || `${store.category}の協賛店`,
                    "address": store.address || "沖縄県",
                    "telephone": store.phone || "",
                    "url": `${window.location.origin}/sponsor-detail.html?id=${store.id}`
                }
            }));
            
            const schemaCollectionPage = document.getElementById('schemaCollectionPage');
            if (schemaCollectionPage) {
                const schema = JSON.parse(schemaCollectionPage.textContent);
                schema.mainEntity.itemListElement = itemList;
                schemaCollectionPage.textContent = JSON.stringify(schema);
            }
        }

        // フィルターとソートの適用
        function applyFiltersAndSort() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const category = document.getElementById('categoryFilter').value;
            const area = document.getElementById('areaFilter').value;
            const sortBy = document.getElementById('sortSelect').value;
            
            // エリア名のマッピング
            const areaKeywords = {
                'naha': ['那覇', 'ナハ', 'naha'],
                'chatan': ['北谷', 'チャタン', 'chatan'],
                'nago': ['名護', 'ナゴ', 'nago'],
                'ishigaki': ['石垣', 'イシガキ', 'ishigaki'],
                'miyako': ['宮古', 'ミヤコ', 'miyako']
            };
            
            // フィルタリング
            filteredStores = allStores.filter(store => {
                const matchesSearch = !searchTerm || 
                    store.storeName.toLowerCase().includes(searchTerm) ||
                    (store.address && store.address.toLowerCase().includes(searchTerm));
                
                const matchesCategory = !category || store.category === category;
                
                // エリアフィルター
                let matchesArea = true;
                if (area && areaKeywords[area]) {
                    matchesArea = areaKeywords[area].some(keyword => 
                        (store.address && store.address.includes(keyword))
                    );
                }
                
                return matchesSearch && matchesCategory && matchesArea;
            });
            
            // ソート
            filteredStores.sort((a, b) => {
                switch(sortBy) {
                    case 'newest':
                        return new Date(b.createdAt) - new Date(a.createdAt);
                    case 'oldest':
                        return new Date(a.createdAt) - new Date(b.createdAt);
                    case 'name':
                        return a.storeName.localeCompare(b.storeName, 'ja');
                    case 'views':
                        return b.totalViews - a.totalViews;
                    case 'bookings':
                        return b.totalBookings - a.totalBookings;
                    default:
                        return 0;
                }
            });
            
            // ページをリセット
            currentPage = 1;
            
            // 表示を更新
            updateDisplay();
            updateActiveFilters(searchTerm, category, area);
            updateStructuredData();
        }

        // アクティブなフィルターの表示更新
        function updateActiveFilters(searchTerm, category, area) {
            const activeFiltersDiv = document.getElementById('activeFilters');
            const filterBadgesDiv = document.getElementById('filterBadges');
            
            const areaNames = {
                'naha': '那覇',
                'chatan': '北谷',
                'nago': '名護',
                'ishigaki': '石垣',
                'miyako': '宮古'
            };
            
            const hasFilters = searchTerm || category || area;
            
            if (hasFilters) {
                activeFiltersDiv.style.display = 'block';
                filterBadgesDiv.innerHTML = '';
                
                if (searchTerm) {
                    filterBadgesDiv.innerHTML += `
                        <span class="filter-badge">
                            検索: "${searchTerm}"
                            <i class="bi bi-x-circle remove-filter" onclick="document.getElementById('searchInput').value = ''; applyFiltersAndSort(); updateUrl();"></i>
                        </span>
                    `;
                }
                
                if (category) {
                    filterBadgesDiv.innerHTML += `
                        <span class="filter-badge">
                            カテゴリー: ${category}
                            <i class="bi bi-x-circle remove-filter" onclick="document.getElementById('categoryFilter').value = ''; document.querySelectorAll('.filter-tab').forEach(t => t.classList.remove('active')); document.querySelector('.filter-tab[data-category=\\'\\']').classList.add('active'); applyFiltersAndSort(); updateUrl();"></i>
                        </span>
                    `;
                }
                
                if (area) {
                    filterBadgesDiv.innerHTML += `
                        <span class="filter-badge">
                            エリア: ${areaNames[area]}
                            <i class="bi bi-x-circle remove-filter" onclick="document.getElementById('areaFilter').value = ''; applyFiltersAndSort(); updateUrl();"></i>
                        </span>
                    `;
                }
            } else {
                activeFiltersDiv.style.display = 'none';
            }
        }

        // 表示の更新
        function updateDisplay() {
            if (filteredStores.length === 0) {
                document.getElementById('storeList').innerHTML = '';
                document.getElementById('paginationContainer').style.display = 'none';
                document.getElementById('emptyState').style.display = 'block';
            } else {
                document.getElementById('emptyState').style.display = 'none';
                renderCurrentPage();
                renderPagination();
                updateStatistics();
            }
        }

        // 現在のページを表示
        function renderCurrentPage() {
            const startIndex = (currentPage - 1) * itemsPerPage;
            const endIndex = startIndex + itemsPerPage;
            const currentStores = filteredStores.slice(startIndex, endIndex);
            
            renderStoreList(currentStores);
            
            // スクロールをトップに
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // 店舗リストのレンダリング
        function renderStoreList(stores) {
            const storeList = document.getElementById('storeList');
            storeList.innerHTML = '';

            stores.forEach(store => {
                const storeCard = document.createElement('div');
                storeCard.className = 'col-md-6 col-lg-4';
                
                const statusClass = store.status === 'active' ? 'status-active' : 'status-pending';
                const statusText = store.status === 'active' ? 'アクティブ' : '審査中';
                const storeInitial = store.storeName.charAt(0);
                
                // 店舗画像またはデフォルトアイコン
                const logoHtml = store.imageUrl 
                    ? `<img src="${store.imageUrl}" alt="${escapeHtml(store.storeName)}" class="store-logo me-3" style="object-fit: cover;">` 
                    : `<div class="store-logo me-3"><i class="bi bi-shop"></i></div>`;
                
                storeCard.innerHTML = `
                    <article class="store-card" itemscope itemtype="https://schema.org/LocalBusiness">
                        <div class="d-flex align-items-start mb-3">
                            ${logoHtml}
                            <div class="flex-grow-1">
                                <h3 class="h5 mb-1" itemprop="name">${escapeHtml(store.storeName)}</h3>
                                <p class="text-muted small mb-1">${escapeHtml(store.category)}</p>
                                <span class="status-badge ${statusClass}">
                                    <i class="bi bi-${store.status === 'active' ? 'check-circle' : 'clock'} me-1"></i>
                                    ${statusText}
                                </span>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <p class="text-muted small mb-2" itemprop="address">
                                <i class="bi bi-geo-alt me-1"></i>
                                ${escapeHtml(store.address) || '沖縄県'}
                            </p>
                            <p class="text-muted small mb-2">
                                <i class="bi bi-telephone me-1"></i>
                                <span itemprop="telephone">${escapeHtml(store.phone) || '電話番号未設定'}</span>
                            </p>
                            <p class="text-muted small mb-2">
                                <i class="bi bi-calendar3 me-1"></i>
                                登録日: ${new Date(store.createdAt).toLocaleDateString('ja-JP')}
                            </p>
                        </div>
                        
                        <div class="row g-2 mb-3">
                            <div class="col-6">
                                <div class="bg-light p-2 rounded text-center">
                                    <small class="text-muted">閲覧数</small>
                                    <div class="fw-bold text-primary">${store.totalViews}</div>
                                </div>
                            </div>
                            <div class="col-6">
                                <div class="bg-light p-2 rounded text-center">
                                    <small class="text-muted">予約数</small>
                                    <div class="fw-bold text-success">${store.totalBookings}</div>
                                </div>
                            </div>
                        </div>
                        
                        <a href="sponsor-detail.html?id=${store.id}" class="btn btn-view-store w-100" data-cta="view_store_${store.id.substring(0,8)}">
                            <i class="bi bi-eye me-1"></i>店舗詳細を見る
                        </a>
                        <meta itemprop="url" content="${window.location.origin}/sponsor-detail.html?id=${store.id}">
                    </article>
                `;
                
                storeList.appendChild(storeCard);
            });
        }

        // ページネーションのレンダリング
        function renderPagination() {
            const totalPages = Math.ceil(filteredStores.length / itemsPerPage);
            
            if (totalPages <= 1) {
                document.getElementById('paginationContainer').style.display = 'none';
                return;
            }
            
            document.getElementById('paginationContainer').style.display = 'block';
            
            const paginationButtons = document.getElementById('paginationButtons');
            paginationButtons.innerHTML = '';
            
            // 前へボタン
            const prevButton = createPageButton('‹ 前へ', currentPage > 1, () => {
                if (currentPage > 1) {
                    currentPage--;
                    renderCurrentPage();
                    renderPagination();
                }
            });
            paginationButtons.appendChild(prevButton);
            
            // ページ番号ボタン
            const pageNumbers = getPageNumbers(currentPage, totalPages);
            pageNumbers.forEach(pageNum => {
                if (pageNum === '...') {
                    const ellipsis = document.createElement('span');
                    ellipsis.className = 'mx-1';
                    ellipsis.textContent = '...';
                    paginationButtons.appendChild(ellipsis);
                } else {
                    const pageButton = createPageButton(
                        pageNum.toString(),
                        true,
                        () => {
                            currentPage = pageNum;
                            renderCurrentPage();
                            renderPagination();
                        },
                        pageNum === currentPage
                    );
                    paginationButtons.appendChild(pageButton);
                }
            });
            
            // 次へボタン
            const nextButton = createPageButton('次へ ›', currentPage < totalPages, () => {
                if (currentPage < totalPages) {
                    currentPage++;
                    renderCurrentPage();
                    renderPagination();
                }
            });
            paginationButtons.appendChild(nextButton);
            
            // 表示範囲の更新
            const startIndex = (currentPage - 1) * itemsPerPage + 1;
            const endIndex = Math.min(currentPage * itemsPerPage, filteredStores.length);
            document.getElementById('currentRange').textContent = `${startIndex}-${endIndex}`;
            document.getElementById('totalItemsDisplay').textContent = filteredStores.length;
            document.getElementById('currentPageDisplay').textContent = currentPage;
            document.getElementById('totalPagesDisplay').textContent = totalPages;
        }

        // ページボタンの作成
        function createPageButton(text, enabled, onClick, isActive = false) {
            const button = document.createElement('button');
            button.className = 'page-button' + (isActive ? ' active' : '');
            button.textContent = text;
            button.disabled = !enabled;
            if (enabled) {
                button.onclick = onClick;
            }
            return button;
        }

        // ページ番号の取得（省略記号付き）
        function getPageNumbers(current, total) {
            const pages = [];
            
            if (total <= 7) {
                for (let i = 1; i <= total; i++) {
                    pages.push(i);
                }
            } else {
                if (current <= 3) {
                    pages.push(1, 2, 3, 4, '...', total);
                } else if (current >= total - 2) {
                    pages.push(1, '...', total - 3, total - 2, total - 1, total);
                } else {
                    pages.push(1, '...', current - 1, current, current + 1, '...', total);
                }
            }
            
            return pages;
        }

        // 統計情報の更新
        function updateStatistics() {
            document.getElementById('totalStores').textContent = allStores.length;
            document.getElementById('displayedStores').textContent = filteredStores.length;
            
            const activeCount = allStores.filter(s => s.status === 'active').length;
            document.getElementById('activeStores').textContent = activeCount;
            
            console.log(`📊 Total: ${allStores.length}, Displayed: ${filteredStores.length}, Active: ${activeCount}`);
        }

        // フィルターのリセット
        function resetFilters() {
            document.getElementById('searchInput').value = '';
            document.getElementById('categoryFilter').value = '';
            document.getElementById('areaFilter').value = '';
            document.getElementById('sortSelect').value = 'oldest';
            
            // タブをリセット
            document.querySelectorAll('.filter-tab').forEach(t => t.classList.remove('active'));
            document.querySelector('.filter-tab[data-category=""]').classList.add('active');
            
            applyFiltersAndSort();
            updateUrl();
        }

        // 観光客登録チェック
        function checkTouristRegistration() {
            // Check if user is registered as tourist
            const touristLogin = localStorage.getItem('touristLogin');
            return touristLogin !== null;
        }

        // 店舗詳細の表示（sponsor-detail.htmlへリダイレクト）
        function viewStoreDetails(storeId) {
            console.log('Navigating to store details for:', storeId);
            window.location.href = `sponsor-detail.html?id=${storeId}`;
        }

        // HTMLエスケープ
        function escapeHtml(text) {
            if (!text) return '';
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }
        // 協賛店編集ボタンのセットアップ
        function setupSponsorEditButton() {
            const sponsorEditBtn = document.getElementById('sponsorEditBtn');
            if (!sponsorEditBtn) return;
            
            sponsorEditBtn.addEventListener('click', function() {
                // 既存のモーダルがあれば削除
                const existingModal = document.getElementById('sponsorLoginModal');
                if (existingModal) {
                    existingModal.remove();
                }
                
                // ログインモーダルを作成
                const modalHtml = `
                    <div class="modal fade" id="sponsorLoginModal" tabindex="-1" aria-labelledby="sponsorLoginModalLabel" aria-hidden="true">
                        <div class="modal-dialog modal-dialog-centered">
                            <div class="modal-content" style="border-radius: 20px; overflow: hidden;">
                                <div class="modal-header" style="background: linear-gradient(135deg, #ffc107, #ff8c42); border: none;">
                                    <h5 class="modal-title text-white" id="sponsorLoginModalLabel">
                                        <i class="bi bi-shop me-2"></i>協賛店ログイン
                                    </h5>
                                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                                </div>
                                <div class="modal-body p-4">
                                    <p class="text-muted mb-4">登録時のメールアドレスと電話番号を入力してください</p>
                                    <div class="mb-3">
                                        <label for="sponsorEmail" class="form-label">メールアドレス</label>
                                        <input type="email" class="form-control" id="sponsorEmail" placeholder="example@email.com" required>
                                    </div>
                                    <div class="mb-3">
                                        <label for="sponsorPhone" class="form-label">電話番号</label>
                                        <input type="tel" class="form-control" id="sponsorPhone" placeholder="090-1234-5678" required>
                                    </div>
                                    <div id="sponsorLoginError" class="alert alert-danger d-none" role="alert"></div>
                                    <div id="sponsorLoginSuccess" class="alert alert-success d-none" role="alert"></div>
                                </div>
                                <div class="modal-footer border-0">
                                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">キャンセル</button>
                                    <button type="button" class="btn btn-warning" id="sponsorLoginSubmit">
                                        <i class="bi bi-box-arrow-in-right me-1"></i>ログイン
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                
                document.body.insertAdjacentHTML('beforeend', modalHtml);
                
                const modal = new bootstrap.Modal(document.getElementById('sponsorLoginModal'));
                modal.show();
                
                // ログインボタンのイベント
                document.getElementById('sponsorLoginSubmit').addEventListener('click', async function() {
                    const email = document.getElementById('sponsorEmail').value.trim();
                    const phone = document.getElementById('sponsorPhone').value.trim();
                    const errorDiv = document.getElementById('sponsorLoginError');
                    const successDiv = document.getElementById('sponsorLoginSuccess');
                    
                    errorDiv.classList.add('d-none');
                    successDiv.classList.add('d-none');
                    
                    if (!email || !phone) {
                        errorDiv.textContent = 'メールアドレスと電話番号を入力してください';
                        errorDiv.classList.remove('d-none');
                        return;
                    }
                    
                    try {
                        const response = await fetch('/api/sponsor-stores');
                        const stores = await response.json();
                        
                        const normalizedPhone = phone.replace(/[-\s]/g, '');
                        const matchedStore = stores.find(store => {
                            const storePhone = (store.phone || '').replace(/[-\s]/g, '');
                            return store.email === email && storePhone === normalizedPhone;
                        });
                        
                        if (matchedStore) {
                            successDiv.textContent = 'ログイン成功！編集ページに移動します...';
                            successDiv.classList.remove('d-none');
                            
                            localStorage.setItem('sponsorSession', JSON.stringify({
                                storeId: matchedStore.id,
                                storeName: matchedStore.storeName,
                                email: matchedStore.email,
                                loginTime: new Date().toISOString()
                            }));
                            
                            setTimeout(() => {
                                window.location.href = 'store-dashboard.html?id=' + matchedStore.id;
                            }, 1000);
                        } else {
                            errorDiv.textContent = '登録情報が見つかりません。メールアドレスと電話番号を確認してください。';
                            errorDiv.classList.remove('d-none');
                        }
                    } catch (error) {
                        console.error('Login error:', error);
                        errorDiv.textContent = 'サーバーエラーが発生しました。しばらくしてからお試しください。';
                        errorDiv.classList.remove('d-none');
                    }
                });
            });
        }
        
        // DOMContentLoaded時に協賛店編集ボタンをセットアップ
        document.addEventListener('DOMContentLoaded', function() {
            setupSponsorEditButton();
        });
    </script>
</body>
</html>
